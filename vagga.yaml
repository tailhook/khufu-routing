containers:
  js:
    setup:
    - !Alpine v3.6
    - !Install [nodejs-npm]
    - &nodeenv !Env
      NODE_PATH: /usr/lib/node_modules
      PATH: /bin:/usr/bin:/usr/local/bin:/usr/lib/node_modules/.bin
      BABEL_DISABLE_CACHE: 1
    - !YarnDependencies
    # for examples
    - !NpmInstall
      - webpack@3.5.3
      - webpack-dev-server@2.7.1
      - ./khufu
      - ./khufu/khufu-runtime
      - babel-loader@7.1.1
      - babel-core@6.25.0
      - incremental-dom@0.5.1
      - redux@3.7.2
    environ: *nodeenv

commands:
  make: !Command
    container: js
    run: [npm, run, build]

  test: !Command
    container: js
    run: [npm, run, test]

  webpack: !Command
    description: Run webpack (useful for compiling examples)
    container: js
    run: [webpack]

  devserver: !Command
    description: Run webpack dev server (useful for viewing examples)
    container: js
    run: [webpack-dev-server]
